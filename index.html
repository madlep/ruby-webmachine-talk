<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=1024, user-scalable=no">

    <title>Webmachine for Ruby</title>

    <!-- Required stylesheet -->
    <link rel="stylesheet" href="core/deck.core.css">

    <!-- Extension CSS files go here. Remove or add as needed. -->
    <link rel="stylesheet" href="extensions/goto/deck.goto.css">
    <link rel="stylesheet" href="extensions/menu/deck.menu.css">
    <link rel="stylesheet" href="extensions/navigation/deck.navigation.css">
    <link rel="stylesheet" href="extensions/status/deck.status.css">
    <link rel="stylesheet" href="extensions/hash/deck.hash.css">
    <link rel="stylesheet" href="extensions/scale/deck.scale.css">
    <link rel="stylesheet" href="extensions/codemirror/deck.codemirror.css">

    <!-- Style theme. More available in /themes/style/ or create your own. -->
    <link rel="stylesheet" href="themes/style/swiss.css">

    <!-- Transition theme. More available in /themes/transition/ or create your own. -->
    <link rel="stylesheet" href="themes/transition/horizontal-slide.css">

    <!-- code mirror theme -->
    <link rel="stylesheet" href="extensions/codemirror/themes/default.css">

    <!-- Required Modernizr file -->
    <script src="js/modernizr.custom.js"></script>
  </head>
  <body class="deck-container">

    <!-- Begin slides. Just make elements with a class of slide. -->

    <section class="slide">
      <h1>Webmachine for Ruby</h1>
    </section>

    <section class="slide">
      <h2>We like Rest</h2>
      <ul>
        <li>Consistent</li>
        <li>Predictable</li>
        <li>Grokable</li>
        <li>Scalable</li>
        <li>Developer Friendly</li>
      </ul>
    </section>

    <section class="slide">
      <h2>DISCLAIMER</h2>
      <img src="images/ThatsNotREST.jpg"/>
      <p>I'm gonna be that guy in a minute</p>
    </section>

    <section class="slide">
      <h2>REST > CRUD</h2>
      <h3>REST?</h3>
      <textarea class="code" mode="ruby" style="display: none;" readonly="readonly">
class BlearghController < ActionController::Base
  def index
  end

  def new
  end

  def create
  end

  def show
  end

  def edit
  end

  def update
  end

  def destroy
  end
end
      </textarea>
      <div class="slide">
        <h3>Yes, but REST does more</h3>
        <p>Wrapping REST around MVC is a leaky abstraction</p>
      </div>
    </section>

    <section class="slide">
      <h2>REST =~ HTTP</h2>
      <h3>To get REST right, you need to get HTTP right</h3>
      <p class="slide">authentication; content type negotiation; caching; redirects; language; http verbs; status codes...</p>
      <h3 class="slide">So let's build REST/HTTP apps shaped around HTTP</h3>
    </section>

    <section class="slide">
      <h2>Doing HTTP properly is hard</h2>
      <p>Actually, doing HTTP "just ok" isn't too hard</p>
      <div class="slide">
        <p>But doing HTTP <strong>properly</strong> is <strong>HARD</strong></p>
        <p>So... do I return a <code>201 Created</code>... Or a <code>409 Conflict</code>... or <code>417 Expectation Failed</code>?... What if the client accepts JSON but has a character set I don't know about?... What if I don't implement that method on that resource?... What if caching headers don't match?... What if the resource doesn't exist, but it's being updated?... Or what about...</p>
        <img src="images/http-headers-status-v3.png"/>
      </div>
    </section>

    <section class="slide">
      <h2>Enter Webmachine</h2>
      <p>Original written in Erlang. Still going strong</p>
      <p>Talking about Ruby port today</p>
    </section>

    <section class="slide">
      <h2>HTTP protocol is FSM</h2>
      <p>So let's just define functions to handle the decision points</p>
      <code>resource_exists? service_available? is_authorized? forbidden? allow_missing_post? malformed_request? uri_too_long? known_content_type? valid_content_headers? valid_entity_length? options allowed_methods known_methods delete_resource delete_completed? post_is_create? create_path base_uri process_post content_types_provided content_types_accepted charsets_provided languages_provided language_chosen encodings_provided variances is_conflict? multiple_choices? previously_existed? moved_permanently? moved_temporarily? last_modified expires generate_etag finish_request handle_exception validate_content_checksum</code>
    </section>

    <section class="slide">
      <h2>Fill in the blanks. Webmachine takes care of playing nice with HTTP for you</h2>
      <textarea class="code" mode="ruby" style="display: none;" readonly="readonly">
class BlearghPostResource < Webmachine::Resource
  def service_available?
    DB.connected?
  end

  def allowed_methods
    %w{GET POST PUT DELETE HEAD}
  end

  def resource_exist?
    @bleargh_post = BlearghPost.find(request.path_info(:post_id))
    !@bleargh_post.nil?
  end

  ...

end
      </textarea>
    </section>

    <section class="slide">
      <h2>Some code</h2>
      <h3><a href="https://github.com/madlep/webmachine_ruby_shortener">https://github.com/madlep/webmachine_ruby_shortener</a></h3>
    </section>

    <section class="slide">
      <h2>Why would you use Webmachine?</h2>
      <ul>
        <li>You're building a REST API</li>
        <li>In multiple languages</li>
        <li>Serving up multiple content types</li>
        <li>Maybe you're doing more than just CRUD</li>
        <li>You know and care what HATEOAS means</li>
      </ul>
      <h2>Why wouldn't you use it?</h2>
      <ul>
        <li>Traditional site. DB → Model → Controller → HTML (use Rails)</li>
        <li>Something super simple (use Sinatra)</li>
      </ul>
    </section>

    <section class="slide">
      <h2>Cheers</h2>
      <p>Julian Doherty</p>
      <p><a href="http://twitter.com/madlep/">@madlep</a></p>
      <p><a href="mailto:madlep@madlep.com">madlep@madlep.com</a></p>
      <h3>Credits</h3>
      <p>Scumbag REST pic from <a href="http://lostechies.com/derickbailey/2012/01/25/rant-thats-not-rest/">Lost Techies</a>
      <p>Basho webmachine wiki for flow diagram</p>
      <p>webmachine</p>
      <p>webmachine ruby</p>
    </section>

    <!-- End slides. -->


    <!-- Begin extension snippets. Add or remove as needed. -->

    <!-- deck.navigation snippet -->
    <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
    <a href="#" class="deck-next-link" title="Next">&#8594;</a>

    <!-- deck.status snippet -->
    <p class="deck-status">
    <span class="deck-status-current"></span>
    /
    <span class="deck-status-total"></span>
    </p>

    <!-- deck.goto snippet -->
    <form action="." method="get" class="goto-form">
      <label for="goto-slide">Go to slide:</label>
      <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
      <datalist id="goto-datalist"></datalist>
      <input type="submit" value="Go">
    </form>

    <!-- deck.hash snippet -->
    <a href="." title="Permalink to this slide" class="deck-permalink">#</a>

    <!-- End extension snippets. -->


    <!-- Required JS files. -->
    <script src="js/jquery-1.7.2.min.js"></script>
    <script src="core/deck.core.js"></script>

    <!-- Extension JS files. Add or remove as needed. -->
    <script src="extensions/hash/deck.hash.js"></script>
    <script src="extensions/menu/deck.menu.js"></script>
    <script src="extensions/goto/deck.goto.js"></script>
    <script src="extensions/status/deck.status.js"></script>
    <script src="extensions/navigation/deck.navigation.js"></script>
    <script src="extensions/scale/deck.scale.js"></script>
    <script src="extensions/codemirror/codemirror.js"></script>

    <script src="extensions/codemirror/mode/ruby/ruby.js"></script>

    <script src="extensions/codemirror/deck.codemirror.js"></script>

    <!-- Initialize the deck. You can put this in an external file if desired. -->
    <script>
      $(function() {
        $.deck('.slide');
      });
    </script>
  </body>
</html>
